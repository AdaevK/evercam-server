defmodule EvercamMedia.Snapshot.SchedulerTest do
  use ExUnit.Case, async: true
  alias EvercamMedia.Snapshot.S3

  test "list_prefixes/2 lists the correct prefixes for a simple example" do
    result = [
      "1453078978",
      "1453078979",
      "145307898",
      "145307899",
      "1453079",
      "14530800",
      "1453080100",
      "1453080101",
      "1453080102",
      "1453080103",
    ]

    assert S3.list_prefixes(1453078977, 1453080104) == result
  end

  test "list_prefixes/2 lists the correct prefixes for a complex example" do
    result = [
      "1453075218",
      "1453075219",
      "145307522",
      "145307523",
      "145307524",
      "145307525",
      "145307526",
      "145307527",
      "145307528",
      "145307529",
      "14530753",
      "14530754",
      "14530755",
      "14530756",
      "14530757",
      "14530758",
      "14530759",
      "1453076",
      "1453077",
      "1453078",
      "1453079",
      "145308",
      "1453090",
      "1453091",
      "1453092",
      "1453093",
      "1453094",
      "1453095",
      "1453096",
      "1453097",
      "14530980",
      "14530981",
      "145309820",
      "145309821",
      "145309822",
      "145309823",
      "145309824",
      "145309825",
      "145309826",
      "145309827",
      "1453098280",
      "1453098281",
      "1453098282",
      "1453098283",
      "1453098284",
      "1453098285",
      "1453098286",
    ]

    assert S3.list_prefixes(1453075217, 1453098287) == result
  end
end
